(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[30],{69841:function(n){"use strict";n.exports=function(n){if(n.length>=255)throw new TypeError("Alphabet too long");for(var e=new Uint8Array(256),r=0;r<e.length;r++)e[r]=255;for(var t=0;t<n.length;t++){var o=n.charAt(t),i=o.charCodeAt(0);if(255!==e[i])throw new TypeError(o+" is ambiguous");e[i]=t}var a=n.length,c=n.charAt(0),s=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function l(n){if("string"!==typeof n)throw new TypeError("Expected String");if(0===n.length)return new Uint8Array;for(var r=0,t=0,o=0;n[r]===c;)t++,r++;for(var i=(n.length-r)*s+1>>>0,u=new Uint8Array(i);n[r];){var l=e[n.charCodeAt(r)];if(255===l)return;for(var f=0,d=i-1;(0!==l||f<o)&&-1!==d;d--,f++)l+=a*u[d]>>>0,u[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");o=f,r++}for(var p=i-o;p!==i&&0===u[p];)p++;for(var h=new Uint8Array(t+(i-p)),x=t;p!==i;)h[x++]=u[p++];return h}return{encode:function(e){if(e instanceof Uint8Array||(ArrayBuffer.isView(e)?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):Array.isArray(e)&&(e=Uint8Array.from(e))),!(e instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===e.length)return"";for(var r=0,t=0,o=0,i=e.length;o!==i&&0===e[o];)o++,r++;for(var s=(i-o)*u+1>>>0,l=new Uint8Array(s);o!==i;){for(var f=e[o],d=0,p=s-1;(0!==f||d<t)&&-1!==p;p--,d++)f+=256*l[p]>>>0,l[p]=f%a>>>0,f=f/a>>>0;if(0!==f)throw new Error("Non-zero carry");t=d,o++}for(var h=s-t;h!==s&&0===l[h];)h++;for(var x=c.repeat(r);h<s;++h)x+=n.charAt(l[h]);return x},decodeUnsafe:l,decode:function(n){var e=l(n);if(e)return e;throw new Error("Non-base"+a+" character")}}}},80400:function(n,e,r){const t=r(69841);n.exports=t("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz")},29822:function(n,e,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/test_swap",function(){return r(8061)}])},94717:function(n,e,r){"use strict";r.d(e,{r:function(){return i}});var t=r(64080),o=r(92960),i=(0,t.Z)((function(n,e){var r=[];return{isLoading:!1,setLoading:function(e){r.indexOf(e)<0&&(r.push(e),n({isLoading:!0}))},finishLoading:function(e){var t=r.indexOf(e);t>=0&&r.splice(t,1),0===r.length&&n({isLoading:!1})},forceFinishAll:function(){r.splice(0,r.length),n({isLoading:!1})},bindLoad$:function(n,r){var t=e();return new o.y((function(e){t.setLoading(n),r.subscribe({next:function(n){return e.next(n)},error:function(r){t.finishLoading(n),e.error(r)},complete:function(){t.finishLoading(n),e.complete()}})}))}}}));e.Z=i},57792:function(n,e,r){"use strict";r.d(e,{K:function(){return c}});var t=r(97458),o=r(72485),i=r(66774),a=r(94717);function c(){var n=(0,a.r)((function(n){return n.isLoading}));return(0,t.jsx)(o.Z,{sx:{height:4},children:n&&(0,t.jsx)(i.Z,{})})}},34345:function(n,e,r){"use strict";var t=r(97458),o=r(81687),i=r(55100),a=r(64056),c=r(42592),s=r(72485),u=r(11313),l=r(86881),f=r(57792),d=r(79892);e.Z=function(n){return function(n){var e=(0,o.useRouter)();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(i.Z,{color:"transparent",sx:{backdropFilter:"blur(20px)"},children:[(0,t.jsx)(f.K,{}),(0,t.jsxs)(a.Z,{children:[(0,t.jsxs)(u.Z,{direction:"row",sx:{flexGrow:1},spacing:1,children:[(0,t.jsx)(s.Z,{sx:{width:32,height:32,backgroundSize:"cover",backgroundImage:"url(/icons/duck_dex_icon_small.png)"}}),(0,t.jsx)(c.Z,{color:"primary",variant:"h6",component:"div",sx:{flexGrow:1},onClick:function(){return e.push("/")},children:"DUCK SWAP"})]}),(0,t.jsx)(u.Z,{direction:"row",spacing:2,children:(0,t.jsx)(l.aD,{sx:{color:"white",background:d.vP}})})]})]}),(0,t.jsx)(s.Z,{sx:{height:68}}),n]})}}},79892:function(n,e,r){"use strict";r.d(e,{I:function(){return t},pY:function(){return i},vP:function(){return o}});var t="linear-gradient(245.22deg, rgb(218, 46, 239), rgb(43, 106, 255), rgb(57, 208, 216)) 100% center / 400% 100%",o="linear-gradient(245.22deg, rgb(218, 46, 239), rgb(43, 106, 255), rgb(57, 208, 216)) 0% center / 400% 100%",i="linear-gradient(246deg, rgb(218, 46, 239) 7.97%, rgb(43, 106, 255) 49.17%, rgb(57, 208, 216) 92.1%)"},8061:function(n,e,r){"use strict";r.r(e),r.d(e,{default:function(){return E}});var t=r(56094),o=r(97458),i=r(21362),a=r.n(i);function c(n,e){if(Object.is(n,e))return!0;if("object"!==typeof n||null===n||"object"!==typeof e||null===e)return!1;const r=Object.keys(n);if(r.length!==Object.keys(e).length)return!1;for(let t=0;t<r.length;t++)if(!Object.prototype.hasOwnProperty.call(e,r[t])||!Object.is(n[r[t]],e[r[t]]))return!1;return!0}var s=r(37867),u=r(74215),l=r(11313),f=r(72485),d=r(42592),p=r(41491),h=r(900),x=r(34345),g=r(43136),v=r(63073),w=r(52983),j=r(70755),A=r(26033),b=r.n(A),y=r(64080),m=r(80400),Z=r(77481),k=(0,y.Z)((function(n,e){return{info:null,tolerance:.8,balanceA:0n,balanceB:0n,lp:0n,refreshInfo:function(r){return(0,j.Z)(b().mark((function t(){var o,i;return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=e().api){t.next=3;break}return t.abrupt("return");case 3:return n((function(){return{swapAccount:r}})),t.next=6,o.getSwapData(r);case 6:i=t.sent,n((function(){return{info:i}}));case 8:case"end":return t.stop()}}),t)})))()},refreshWallet:function(){return(0,j.Z)(b().mark((function r(){var t,o,i,a,c,s,u,l;return b().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t=e(),o=t.api,i=t.info,a=t.swapAccount,!((c=v.Z.getState().owner)&&o&&i&&a)){r.next=13;break}return r.next=5,o.getAccountByATA(i.tokenPool,c).catch((function(){}));case 5:return s=r.sent,r.next=8,o.getAccountByATA(i.mintA,c).catch((function(){}));case 8:return u=r.sent,r.next=11,o.getAccountByATA(i.mintB,c).catch((function(){}));case 11:l=r.sent,n((function(){var n,e,r;return{lp:null!==(n=null===s||void 0===s?void 0:s.amount)&&void 0!==n?n:0n,balanceA:null!==(e=null===u||void 0===u?void 0:u.amount)&&void 0!==e?e:0n,balanceB:null!==(r=null===l||void 0===l?void 0:l.amount)&&void 0!==r?r:0n}}));case 13:case"end":return r.stop()}}),r)})))()},applySwap:function(n,r){return(0,j.Z)(b().mark((function t(){var o,i,a,c,s,u,l,f,d;return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=e(),i=o.api,a=o.info,c=o.swapAccount,s=o.tolerance,o.refreshInfo,o.refreshWallet,!(i&&a&&c)){t.next=15;break}return n.equals(a.mintA)?(u=a.mintA,l=a.mintB):(u=a.mintB,l=a.mintA),t.next=7,i.getATA(u,i.payerPubkey);case 7:return f=t.sent,t.next=10,i.getATA(l,i.payerPubkey);case 10:return d=t.sent,console.log("swap in amount",r),t.next=14,i.applySwapTx({swapAccount:c,user:i.payerPubkey,sourceAccount:f,destinationAccount:d,amountIn:r,tolerance:s});case 14:t.sent;case 15:case"end":return t.stop()}}),t)})))()},depositForLP:function(n){return(0,j.Z)(b().mark((function r(){var t,o,i,a,c,s;return b().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!((t=e()).api&&t.info&&t.swapAccount)){r.next=27;break}return r.next=4,t.api.prepareToSwapTx({poolMint:t.info.tokenPool,tokenAMint:t.info.mintA,tokenBMint:t.info.mintB});case 4:return o=r.sent,r.next=7,t.api.swapDepositTx({swapAccount:t.swapAccount,user:t.api.payerPubkey,forPoolTokenAmount:n,tolerance:t.tolerance});case 7:if(i=r.sent,!o){r.next=12;break}r.t0=o.add(i),r.next=15;break;case 12:return r.next=14,t.api.emptyTransaction();case 14:r.t0=r.sent.add(i);case 15:return a=r.t0,r.next=18,v.Z.getState().signAllTransactions([a]);case 18:return c=r.sent[0],s=(0,m.encode)(c.signature),console.log("signed sig",s),Z.Z.getState().logTx("apply swap",s),r.next=24,t.api.connection.sendRawTransaction(c.serialize(),{preflightCommitment:"confirmed"});case 24:Z.Z.getState().closeTx(s),t.refreshInfo(t.swapAccount),t.refreshWallet();case 27:case"end":return r.stop()}}),r)})))()}}})),B=k,S=r(14896);function T(){var n=(0,g.ZP)();return console.log(n),(0,o.jsxs)(h.Z,{sx:{p:3},children:[(0,o.jsx)(d.Z,{variant:"h4",children:"Connection Pad"}),(0,o.jsxs)(d.Z,{children:["connected: ",n.connection?"ok":"failed"]}),(0,o.jsxs)(d.Z,{children:["inHeartbeat: ",n.isInHeartbeat?"yes":"no"]}),(0,o.jsxs)(d.Z,{children:["version: ",n.version]})]})}function P(){var n,e,r=(0,v.Z)();return(0,o.jsxs)(h.Z,{sx:{p:3},children:[(0,o.jsx)(d.Z,{variant:"h4",children:"Wallet Pad"}),(0,o.jsxs)(d.Z,{children:["owner: ",null===(n=r.owner)||void 0===n?void 0:n.toBase58()]}),(0,o.jsxs)(d.Z,{children:["balance: ",((null===(e=r.solBalance)||void 0===e?void 0:e.toNumber())||0)/s.j5]})]})}function L(){var n="B2Ue1M4X1U1zhXfY97Mc1f7Xfn1fNwikb5v1wd8Devgy";!function(){var n=(0,g.Rc)((function(n){return n.connection})),e=(0,v.O)((function(n){return n.owner}));(0,w.useEffect)((function(){k.setState((function(){return n&&e?{api:new S.c$(e,n)}:{api:void 0}}))}),[n,e])}(),function(n){(0,w.useEffect)((function(){if(n&&""!==n){var e=new s.nh(n);k.getState().refreshInfo(e)}}),[n])}(n);var e=B((function(n){var e;return null===(e=n.api)||void 0===e?void 0:e.payerPubkey})),r=(0,t.Z)(B((function(n){return[n.api,n.info,n.balanceA,n.balanceB,n.lp]}),c),5),i=r[0],a=r[1],u=r[2],l=r[3],x=r[4];return(0,o.jsxs)(h.Z,{sx:{p:3},children:[(0,o.jsx)(d.Z,{variant:"h4",children:"Swap Pad"}),(0,o.jsxs)(d.Z,{children:["payer: ",null===e||void 0===e?void 0:e.toBase58()]}),i?(0,o.jsx)(f.Z,{children:(0,o.jsx)(p.Z,{color:"primary",variant:"outlined",onClick:function(){i.connection.requestAirdrop(e,s.j5)},children:"request airdrop 1 sol"})}):void 0,(0,o.jsxs)(d.Z,{children:["swapAddress: ",n]}),(0,o.jsx)(p.Z,{color:"primary",variant:"outlined",onClick:function(){B.getState().refreshInfo(new s.nh(n))},children:"refresh info"}),a?(0,o.jsxs)(f.Z,{sx:{p:1},children:[(0,o.jsxs)(d.Z,{children:["Swap Token A: ",a.mintA.toBase58()]}),(0,o.jsxs)(d.Z,{children:["Swap Token A amount: ",Number(a.amountA)/s.j5]}),(0,o.jsxs)(d.Z,{children:["Swap Token B: ",a.mintB.toBase58()]}),(0,o.jsxs)(d.Z,{children:["Swap Token B amount: ",Number(a.amountB)/s.j5]}),(0,o.jsx)(p.Z,{color:"primary",variant:"outlined",onClick:function(){B.getState().applySwap(new s.nh("BTCvzov3oGXVtiNLr9FLg5uxya9uuqmJiUXDCAX8Ech3"),BigInt(.1*s.j5|0))},children:"Swap 0.1 BTC to USD"}),(0,o.jsx)(p.Z,{color:"primary",variant:"outlined",onClick:function(){B.getState().applySwap(new s.nh("USD1qsqeuzds7E7yNPxdWMcw7AonmaWyXi66Fa7XmM7"),1000n*BigInt(s.j5))},children:"Swap 1000 USD to BTC"})]}):void 0,(0,o.jsxs)(d.Z,{children:["wallet address: ",null===e||void 0===e?void 0:e.toBase58()]}),(0,o.jsx)(p.Z,{color:"primary",variant:"outlined",onClick:function(){B.getState().refreshWallet()},children:"refresh wallet"}),e?(0,o.jsxs)(f.Z,{sx:{p:1},children:[(0,o.jsxs)(d.Z,{children:["balanceA: ",Number(u)/s.j5]}),(0,o.jsxs)(d.Z,{children:["balanceB: ",Number(l)/s.j5]}),(0,o.jsxs)(d.Z,{children:["balanceLP: ",Number(x)/s.j5]}),(0,o.jsx)(p.Z,{color:"primary",variant:"outlined",onClick:function(){B.getState().depositForLP(BigInt(.1*s.j5))},children:"offer LP for 0.1 LP"})]}):void 0]})}var C=function(){return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(a(),{children:(0,o.jsx)("title",{children:"test swap"})}),(0,o.jsx)(u.Z,{maxWidth:"md",children:(0,o.jsxs)(l.Z,{alignItems:"center",spacing:2,children:[(0,o.jsx)(L,{}),(0,o.jsx)(P,{}),(0,o.jsx)(T,{})]})})]})};C.getLayout=(0,x.Z)();var E=C}},function(n){n.O(0,[719,774,888,179],(function(){return e=29822,n(n.s=e);var e}));var e=n.O();_N_E=e}]);